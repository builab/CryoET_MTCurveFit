Some code is based on 
https://github.com/PengxinChai/multi-curve-fitting
